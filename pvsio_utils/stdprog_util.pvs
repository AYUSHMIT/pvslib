stdprog_util[T:TYPE+] : THEORY
BEGIN

  reset(v:Mutable[T]) : void

  unwind_protect_lift(ft:[Dummy->T],fs:[Dummy->void]) : T

  % Evaluate the t, returning its value. The cleanup code will be evaluated if control leaves t.
  unwind_protect(t:T,cleanup:void) : MACRO T =
    unwind_protect_lift(LAMBDA(d:Dummy):t,LAMBDA(d:Dummy):cleanup)

  undefined?(v:Mutable[T]) : MACRO bool =
    undef(v)

  defined?(v:Mutable[T]) : MACRO bool =
    NOT undef(v)

END stdprog_util
